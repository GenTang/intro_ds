计算机应用研究
APPLICATION RESEARCH OF COMPUTERS
2000　Vol.17　No.2　P.87-89



基于网络环境的超媒体开发工具的设计与实现
黄迪明　张晓进　廖建明
摘 要 此系统是以超媒体技术和网络通信技术为基础，通过面向对象设计和编程方法研制开发的基于网络环境的超媒体开发工具，它为教师制作CAI课件以及学生访问课件提供了一个良好而简易的操作环境。此系统由超媒体编缉工具、超媒体浏览工具和超媒体服务器等三个部分组成。介绍用VC++开发的该系统的性能特点，讨论实现中的一些关键技术。
关键词 超媒体 开发工具 编辑器 浏览器 服务器
1 引言
　　基于网络环境的超媒体开发工具是一种既具有通用超媒体开发工具的基本功能，又特别适用于开发CAI课件的开发系统，它是前电子工业部“九五”科研项目。
　　该工具是为开发CAI软件而设计、实现的一个支撑软件环境。它包括超媒体编辑工具、超媒体浏览工具和超媒体服务器三个主要部分。其关键技术包括面向对象设计和编程技术、多媒体技术、超媒体技术和网络通信技术。
2 系统结构、功能及运行环境
2.1 系统结构
　　基于网络环境的超媒体开发工具主要是为教师和学生创建一个适合于现代信息时代发展的教学方式的环境。从“教”和“学”的关系模型看，可以将整个软件工具组分为服务端和客户端两个部分。系统功能模型的整体结构如图1所示。

图1　系统功能模型
　　1)服务端(教师方面)：超媒体编辑模块(素材编辑、组织编辑)、超媒体服务器模块。
　　2)客户端(学生方面)：超媒体浏览模块(本地超媒体浏览、远程超媒体浏览)。
2.2 系统功能
2.2.1 超媒体编辑功能
　　现有的许多写作工具是采用脚本描述的方式来实现的，缺点是不直观，文档的作者需要记忆脚本语言的语法和关键词，使用不方便。本系统则采用以页为单位组织多媒体数据，在每一页中分布着各种媒体(文字、图形图象、声音、动画和视频)以及跳转控制(锚点)。编辑时对编辑好的媒体素材以按钮图标的形式，通过鼠标点取，在显示屏上以所见即所得(WYSIWYG)的方式安排各媒体的具体位置、大小。完全不必记忆任何词法语法，易于掌握和使用。
　　为实现超媒体文档的动态性，本工具的媒体数据中可以包含按钮、单选框、复选框等动态控件，以实现信息反馈。该工具通过对动态链接库(DLL)或对象的链接和嵌入(OLE)实现了工具的开放性和扩展性。超媒体编辑工具的结构如图2所示。

图2　超媒体编辑工具结构示意图
2.2.2 超媒体服务器功能
　　本系统是建立在Windows95平台上，基于TCP/IP协议组，采用Windows Sockets作为编程接口实现网络通信功能。“教”和“学”的关系是客户(学生)和服务器(教师)的关系，编程时采用HTTP服务通信模型实现“客户/服务器”的通信要求。服务器实现的主要功能有：
　　●服务器可以实现对统一资源定位器(URL)的解释，完成客户端所需要的服务。
　　●服务器可以定义一个客户访问的目录及缺省主页，这样学生可以根据服务器的地址来访问页面，而教师通过服务器发布页面。
　　●服务器显示屏上可以显示访问的客户地址、时间和页面，这可以让教师了解发布页面的访问情况。
2.2.3 超媒体浏览功能
　　超媒体浏览工具主要实现对媒体数据流的解释功能，使多媒体在屏幕上再现；对远程超媒体文档的请求访问功能，把数据流传输到本地机上进行浏览。其实现的主要功能有解释器功能和资源请求功能。超媒体浏览工具的结构如图3所示。

图3　超媒体浏览工具结构
2.3 系统运行环境
　　硬件配置
　　单机配置：486DX以上微机，内存8M以上，6M以上的硬盘剩余空间。
　　多媒体配置：24倍速光驱，SoundBlaster兼容声卡，音箱。
　　网络配置：NE2000兼容网卡，通过集线器连接起来的微机机群。
　　操作系统
　　中文Windows95或Windows98。
3 实现技术
3.1 面向对象编程技术
　　实现超媒体编辑工具的关键在于如何有机地把各种多媒体数据组合在一个视窗之中。不同的媒体有着不同的表现方式。例如文本媒体负责显示一定颜色、字体的文字。图形图象负责显示画面，声音由音频流组成，而视频则包含一帧帧视频流。然而，各种不同的媒体又有某些共性，如媒体的位置、大小、名称是它们共有的属性。要实现多媒体数据的有机组织，就要充分考虑到各种媒体的共性和个性两个方面。C++的多态性技术正是实现多媒体组织的理想方法。
　　超媒体编辑工具的主要功能就是把各种媒体数据有机地结合在同一个显示屏内，能存储和再现，并且可改变各媒体的属性，这正是通过C++的多态性来实现的。图4显示出该编辑工具处理的媒体类型。

图4　媒体类一览
　　从图4中可以看出，该编辑工具包含多种媒体数据，它们都由一个称作BaseForm的基类直接派生而出。
　　基类BaseForm的成员和成员函数是以下各媒体类的共同属性和公共的操作方法，如媒体的位置、大小及其获取或设置其值的方法。通过继承基类的成员及成员函数，或重载其成员函数，可以减少媒体类的代码量，实现程序的优化；并且，若需要新的媒体类，能方便地从基类派生，使程序具有易于扩展的功能。各媒体类具体实现了编辑工具中各个媒体的展现功能，体现了类的多态性。
　　从以上可以看出，通过对不同媒体类的划分，不仅能充分发挥单个媒体的个性，而且具有良好的开放性，易于软件的扩充和升级。
　　媒体的复杂性使超媒体文档丰富多彩，但是程序实现时需要一条“链”把各个媒体有机地串联在一起，高效率地实现其展现、处理、存储、装载和传输，则需要面向对象的“一种界面,多种实现”的思想方法。
　　如图5所示，正是媒体类的基类链把文档的全部媒体链接起来。在处理各媒体时，通过指针的强制转换把基类指针指向子类。图中的虚线即表示基类链的元素同该虚线另一端的子类链表示的元素指向同一对象，只不过指针类型不同而已，从而实现对具体媒体的访问。

图5　各类媒体链表
3.2 多媒体技术
　　多媒体是利用计算机和相关技术设备对图、文、声、像、程序等多种媒体信息进行数字化获取、管理、通信、处理，并能通过和用户的交互对话向用户提供所需信息的新一代计算机集成环境。超媒体开发工具正是把文本、图形图象、音视频、程序控制等多媒体数据方便地结合在一起的工具。
　　该开发工具对Windows标准位图BMP文件、Internet上使用频率最高的GIF、JPEG图象文件、ICON图标文件和Windows元文件的显示分别加以实现，这样能充分结合Win95和网络传输的特性，发挥软件的最大优势。程序中对图形图象的显示还保留了扩展接口以便于程序员今后升级软件时实现更多形式的图形图象。
　　本开发工具对音视频的实现主要考虑到以下多媒体系统结构设计的两个原则：第一，可扩充性；第二，独立于设备。可扩充性允许软件结构方便地适应于技术的发展而不影响系统的本身结构。独立于设备则方便了多媒体软件的开发，使得开发的程序可以在多种硬件下运行。
　　根据上述原则，程序对音视频的控制采用了媒体控制接口(MCI)，它在控制如音频、视频等外围设备方面提供了与设备无关的代码，用户程序可以使用MCI控制标准的多媒体设备，如音视频播放设备，动画播放设备等。由于MCI的设备无关性，系统升级简易方便，使用它无需了解各种多媒体产品的技术细节，大大提高了系统的开发效率。
　　为了方便程序员对程序的控制，该开发工具专门设置了一个DLL(Dynamic Library Link)接口，使熟悉编程的程序员进行DLL的编制，以便对开发工具进行更大程度的控制。
3.3 超文本/超媒体技术
　　本系统实现的超文本/超媒体结构是以页作为基本单位(节点)，页面中可以包含文本、图形图象、声音和视频等多种媒体数据，这样用户能在页面内以灵活的方式任意组织各种媒体。每页之间用链链接在一起，读者不再只能以顺序的方式阅读页面，可以通过链直接跳到自己感兴趣的页面。
3.4 网络通信技术
3.4.1 Windows Socket编程
　　本系统是基于TCP/IP网络通信协议来实现的。编程界面有两种方式：一是由网络操作系统内核直接提供的系统调用，显然它需要用户对网络操作系统有深入的了解，这种方法很不直观且程序移植困难；另一种编程界面是以库函数形式提供给用户，有关TCP/IP协议的各种实现都包含在库函数中，用户通过调用这些函数来编写TCP/IP应用程序，这种编程界面叫做套接字(Socket)。本系统就是利用Windows操作系统下提供的编程界面WinSock来实现网络(局域网或因特网) 上页面的访问。
3.4.2 Client/Server模式
　　客户/服务器体系结构已经成为网络计算机的主要方式。基于TCP/IP网络通信的主要模式也是客户机/服务器方式。
　　本系统中，浏览器作为客户进程，而服务器进程不断监测网络消息。客户程进程发送请求给服务器进程，服务器进程对客户机的请求作出响应，并产生结果。
3.4.3 HTTP协议
　　HTTP包含了浏览器和服务器之间通信的所有内部操作，它是当前专门为Web网而设计的一种网络协议，本项目为了实现网络通信的标准化，所以在课件浏览器与服务器之间也采用HTTP通信方式。
　　HTTP是Web网的通信规则集，与Internet协议共同传输Web数据。HTTP是Web上的图形、图象、音频、视频、超文本等信息的传输载体。浏览器和服务器每进行一次HTTP操作，就建立一次连接，随即又断开此次连接。一次HTTP操作称为一次事务(Transaction)。HTTP采用TCP/IP连接，而且该连接仅在此次事务中保持。无论是浏览器还是服务器都不会记忆上次连接的状态。无论什么时候用户单击超链，服务器都假设用户想退出浏览，因而先断开连接，再建立新的连接。用这种方法断开连接，使服务器可以响应其它用户的请求，提高服务器的工作效率。
4 结束语
　　超媒体技术所包含的多媒体技术和网络通信技术等都是现代科学技术的前沿课题，在研究过程中会有许多难题需待解决，这也正是其发展潜力和价值所在。我们正朝着超媒体信息以更快的速率、更多的媒体数据把丰富多彩的世界展现给世人的方向努力。本项目的设计开发工作正是在这种大环境下所作的一次尝试。本项目自主开发完成的软件成果，对推动教学改革、提高教学质量具有重要的意义，其推广应用将具有广泛的社会影响和经济价值。
本课题获原电子部“九五”科研项目资助
黄迪明（电子科技大学计算机学院 成都 610054）
张晓进（电子科技大学计算机学院 成都 610054）
廖建明（电子科技大学计算机学院 成都 610054）
参考文献
1，Brent E.Rector and Joseph M.Newcomer, Win32 Programming. by Addison Wesley Longman, Inc, 1997
2，David J.Kruglinski. Visual C++TM技术内幕. 北京: 清华大学出版社, 1994年11月
3，Ralf Steinmetz and Klara Nahrstedt. Multimedia: COMPUTING, COMMUNICATIONS and APPLICATIONS, by Prentice-Hall International, Inc, 1995
收稿日期：1999年7月26日
