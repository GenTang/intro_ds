计算机应用研究
APPLICATION RESEARCH OF COMPUTERS
2000　Vol.17　No.2　P.55-57



远程医疗系统的网络安全性研究
郝琴　唐建　丁鹏　盛焕烨
摘 要 随着多媒体及计算机网络技术的高速发展，基于Internet的远程医疗系统的研究步伐也日益加快，作为一个开放的分布式网络，远程医疗系统面临着严重的网络安全问题。结合上海交通大学研制开发的互联远程医学网模型，提出了一种适合远程医疗系统的认证体系，并详细分析和阐述了该体系的设计与实现过程。
关键词 远程医疗 网络安全 认证 安全套接字
1 前言
　　计算机科学作为一门新兴的学科，自它诞生之日起就以一种超过其它任何科学的速度飞快发展，给世界带来了巨大的变革。近年来，计算机网络技术的迅猛发展，已广泛地应用到社会各行各业，基于Internet的远程医疗系统(Telemedicine)就是其中具有实用价值的一项重要应用。
　　远程医疗是计算机科学、通信技术与医学相结合的新兴的科学与市场相结合的领域。作为一个开放的分布式的医疗系统，它应包括：远程诊断(Remote Diagnosis)、专家会诊(Consultation of Specialists)、信息服务(Information Service)、在线检查(Online Examination)和远程学习(Remote Studying)等部分。国外在该领域已作了数十年的研究，在远程诊断、远程会诊、X光片和CT图形的远距离传输、远程挂号、远程学习和信息共享等方面已取得重要进展。国内起步相对较晚，但发展较快，目前已有十几家在从事远程医疗系统的开发[1]。上海交通大学建立并实现了国内第一家比较完善的远程医疗系统－“互联远程医学网”[8]，该系统具有良好的实用性、可维护性和可扩展性，用户界面友好，操作方便，达到了国际先进水平。与其它所有开放式网络系统一样，它同样面临着网络安全问题。为防止非法入侵者对分布式系统的攻击，保护合法用户的权益，我们需要在网络中采用安全服务，包括认证、访问控制、机密性、完整性等。其中，解决认证问题是网络安全的前提和基础。
　　本文首先介绍了远程医疗系统及网络安全，特别是认证问题。最后结合研制开发“互联远程医学网”的实践经验，提出了一种适合远程医疗系统的认证体系，并对该体系及其实现作了详细的分析和阐述。
2 基于Internet的远程医疗系统
　　远程医疗是计算机科学、通信技术与医学相结合的综合系统。从计算机科学的角度来看，远程医疗系统由两大部分组成：网络和软件。运用HTML、VB Script和VC++，我们开发出一套基于Web/Browser架构的远程医疗会诊系统软件－“互联远程医学网”。服务器端采用Windows NT、IIS和SQL Server构造Web Server，客户端用户采用Microsoft IE浏览器。“互联远程医学网”网络体系结构采用Internet/Intranet架构，由网上专家、网上医院和网上中心三大部分组成，可以采用电话拨号、ISDN、VSAT(卫星)、DDN、Frame-Relay(帧中转)等不同带宽的通信手段访问(如图1所示)。

图1　“互联远程医学网”系统结构
3 计算机网络安全
　　随着计算机和通信技术的迅猛发展，导致了计算机系统由集成式、单机式向分布式系统(网络化的工作站)的发展。进入90年代来，随着全球计算机网络的日益扩大，人们已充分认识到分布式系统带来的好处：高性能、高可靠性、高灵敏度、可扩充性以及系统透明性等。然而，与传统的计算机系统相比，网上的安全问题因网络的开放、互联而更加复杂，网上的传输信息量之大、系统之复杂使得对信息流动进行跟踪记录几乎不可能，数据的完整性、保密性难以保障。连接到网上的系统，其资源、服务有可能被非法使用，甚至破坏。这些威胁无论在公司私有网、校园网、医疗网、Internet上均程度不同地存在，限制了其在政府、商业等对安全要求很高的部门的应用，网络的安全性受到越来越多的关注[2,3]。为防止对分布式系统的攻击，保护合法用户的权益，需要在网络中采用安全服务，包括认证、访问控制、机密性、完整性等，认证问题是网络安全的前提和基础。
　　认证(Authentication)是网络中达到存取控制最基本的方法[7]。经由认证，通信双方可以验证对方的真实身份；对传输信息的真伪鉴定；以及对双方进行秘密通信时所用的通信密钥达成共识，是否真实的过程。其目的有二：第一，验证信息的发送者是真实的，而不是假冒的，即信源识别；第二，验证信息的完整性，在传输或传输过程中未被纂改、重放或延迟等。认证是安全性的关键，它的失败将导致整个系统的失败。理想的认证系统应是建立在密码学基础上，高度安全和可行的。目前在世界上有许多认证系统，其中Kerberos，TESS，SPX是已由IETF组织以RFC(征求意见稿)发布了的，影响较大、使用范围广的认证系统。但这三个已成为国际标准的认证系统，各自均存在着不同的局限性[10, 12]。
　　近年来，Netscape提出一种名为安全套接字层的协议(SSL)并应用于Netscape浏览器中。随着Web浏览器技术的发展，SSL已被工业界认可，并成为IETF的RFC草案[4,5]。在操作系统中SSL位于TCP和应用层协议(HTTP、SMYP、FTP之间)。SSL采用了公用密钥和专有密钥两种钥匙，运用公用钥匙机密技术进行加密。
　　本文作者在研究“互联远程医学网”网络安全的过程中博采众家之长，并在此基础上提出了基于SSL技术，适合远程医疗系统的认证协议。
4 远程医疗系统认证体系的描述及分析
　　如前所述，“互联远程医学网”体系结构采用Internet/Intranet架构，作为一个开放式网络，“互联远程医学网”不可避免地需要解决网络安全问题。本系统除利用NT、SQL Server的安全机制和可靠性机制以及极少的一些简单口令检查外，整个系统还通过身份认证等手段来防止非授权人员的读写、传输过程的正确性和一致性[9]。
4.1 认证的必要性分析
　　“互联远程医学网”由网上专家、网上医院和网上中心三部分组成，其认证体系由以下三个部分组成：
　　(1)网上中心和网上医院的双向身份认证
　　网上中心和网上医院之间的信息流动主要表现为：医院向中心提出会诊申请，发送病人资料；中心通知医院会诊安排，允许医院调阅相关病人资料。因此，网上医院必须对网上中心进行身份认证，保证信息的安全传送，避免冒牌会诊中心的非法参与。另一方面，会诊中心也有必要对网上医院进行身份认证，防止非网上医院的用户盗用、篡改，甚至破坏系统资源。
　　(2)网上中心和网上专家的双向身份认证
　　网上中心和网上专家的信息流动主要表现为：中心与专家联系，安排会诊时间；专家可从中心调阅相关病人资料。因此，网上中心和网上专家的双向身份认证目的有二：一方面专家确保会诊是由合法的会诊中心安排，避免非法用户无偿盗用专家的劳动成果；另一方面，会诊中心防止非授权用户盗用、纂改，甚至破坏系统资源。
　　(3)网上医院和网上专家的双向身份认证
　　网上医院和网上专家的信息流动主要是召开视频会议，对病人病情进行会诊。他们之间双向身份认证目的也有二：一方面专家确保是与合法的网上医院进行会诊；另一方面，医院确保参与会诊的不是冒牌专家，以免给病人带来无法挽回的后果。
4.2 认证的具体描述
4.2.1 使用前提
　　“互联远程医学网”认证系统也需要一个可信第三方提供CA服务。简单起见，我们认为网上中心兼此功能。若使认证系统安全有效地运行，首先必须满足以下使用前提：
　　(1)CA(即网上中心)先用RSA算法产生自己的公开密钥和私有密钥。
　　(2)合法的用户(包括网上医院和网上专家)都要到CA注册，获得CA的公开密钥及自身的公开密钥、私有密钥及唯一的标识号。
　　(3)CA组织发行的用户档案，即公钥证书(Certification)如下：
　　用户档案 用户公开密钥
　　用户其它信息 发证机关名称 ......
　　本系统虽然也有CA机构，它与Kerberos或Tess等认证系统中的AS(Authentication Server)、SKIA(安全密钥发行机构)有本质的区别。这里的CA仅作为可信第三方，为合法用户发行公钥证书。而不像AS、SKIA那样作为中央式的认证服务器来为网络的用户及服务器提供专职的认证服务。因此，“互联远程医学网”认证系统的工作模式如图2所示。

图2　“远程医学网”认证系统工作模式
4.2.2 安全前提
　　“远程医学网”认证系统的安全性建立在如下基础上：
　　(1)选用的加密/签名算法(如RSA、MD5)是实际安全的。
　　(2)用户的私有密钥只有用户知道。
　　(3)用户对CA所提供的信息是信赖的。
4.3 认证系统的实现
　　“互联远程医学网”是基于SSL的安全WWW系统。从系统实现角度，安全WWW系统由以下部分构成：
　　(1)握手协议模块。建立本次连接的会话密钥，为密码组件生成报文加密密钥和信息完整性鉴别密钥，实现浏览器和Web服务器的双向身份鉴别。
　　(2)密码组件。对发送队列和接收队列的数据进行加密、解密和信息完整性检验。
　　(3)密钥管理进程。完成公钥证书的获取，并将信息传送至握手协议模块。
　　握手协议在密码学意义上实现了客户和服务器之间的双向鉴别、密钥交换和保密会话。其安全性建立在离散对数(DH协议)或整数分解(RSA协议)的难题上[11]。
　　安全套接字层的握手协议是为客户和服务器双方进行保密通信前确定安全参数、密钥、算法和同步的协议，其工作可以分为两个阶段(图3从密钥交换和安全方面意义上对此进行了描述)[6]：

图3　握手协议
　　①建立私人连接(Private Connection)。
　　客户端首先发送CLIENT-HELL0，服务器端收到此消息后以SERVER-HELL0作为回应。若此时双方认为不需要新的主密钥(Master Key)，那么连接建立完毕，直接进入第二阶段。否则，SERVER-HELL0应包括如公钥证书(Certification)、密码算法、连接标识号(Connection-ID)等信息以便客户端生成新的主密钥。客户产生主密钥，然后以服务器公钥证书中提供的公用密钥加密后在CLIENT-MASTER-KEY中传送给服务器。最后，服务器发送SERVER-VERIFY予以确认。至此完成了对服务器的认证(因为只有合适的私钥才能对加密后的主密钥进行解密)。客户端和服务器根据主密钥产生各自的公用密钥和私有密钥：SERVER-READ-KEY、CLIENT-WRITE-KEY、CLIENT-READ- KEY和SERVER-WRITE-KEY。
　　②客户端认证。
　　第一阶段完成对服务器的认证，本阶段主要是对客户端的认证。客户端必须提供要求的所有信息。任何一方完成对对方的认证后都应发送“结束消息”。对于客户端，应发送CLIENT-FINISHED；对于服务器端，应发送SERVER-FINISHED。
5 结束语
　　本文结合上海交通大学研制的“互联远程医学网”，介绍了基于Internet的远程医疗系统及其网络安全问题，提出了一种适合远程医疗系统的基于SSL协议的身份认证体系，并对其设计和实现的有关技术问题作了详细的分析和探讨。本文的后续工作是如何运用SSL协议，如何将其嵌入操作系统内核，使安全机制对所有上层应用软件透明。
郝琴（上海交通大学计算机科学与工程系 上海 200030）
唐建（上海交通大学计算机科学与工程系 上海 200030）
丁鹏（上海交通大学计算机科学与工程系 上海 200030）
盛焕烨（上海交通大学计算机科学与工程系 上海 200030）
参考文献
1，Linder A.Global. Telemedicine Report. Telemedicine Journal 1996, 3(4): 15
2，Roger Clarke Internet Privacy Concerns Confirm the Case for Intervention. COMMUNICATION OF THE ACM February 1999/Vol.42, No.2
3，Patrick W.Dowd. Network Security: It's Time to Take It Seriously. Computer September, l998
4，http://www.netscape.com/newsref/ref/internet_security.html
5，http://www.netscape.com/comprod/server_central/config/secure.html
6，http://www.netscape.com/eng/ss13/ss1_talk.html
7，孙晓蓉等. 网络和分布式系统中的认证. 计算机研究与发展,Vo.35, No.10, 1998/10
8，夏 峰. 上海医科大学远程医疗系统模型的建立和研究. 软件学报, Vo1.9, No.3 1998/3
9，沈显君, 归伟夏, 冯 刚等. 基于Internet的远程教育软件的设计与实现. 计算机应用研究,Vol.16, No.5, 1999
10，薛 强等. 基于可信赖服务器的会议密钥分发协议. 小型微型计算机系统 Vol.20, No.3 1999/3
11，韦 卫. 基于SSL的安全WWW系统的研究与实现. 计算机研究与发展, Vol.36, No.5 1999/5
12，吴家平. 网络认证体系的通用程序设计. 计算机应用研究, Vol.15, No.4 1998
收稿日期：1999年9月13日
