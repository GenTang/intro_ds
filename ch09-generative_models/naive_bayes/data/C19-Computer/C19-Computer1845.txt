微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.53-54




微机硬盘引导扇区故障的解析与修复
张红
摘 要： 对硬盘引导扇区的内容、功能加以分析，讨论其发生故障的现象、原因和修复方法。
关键词： 硬盘 主引导扇区 引导扇区 扇区故障
　　硬盘具有体积小，容量大，存取速度快，记录密度高的特点，由于硬盘内磁盘的盘片和磁头都被密封，硬盘制造时空气要通过高效过滤口才能进入密封室内，所以硬盘的硬故障，即物理损坏，如盘片划伤，驱动器控制系统损坏等发生率大大低于另一种软故障，如病毒感染，配置不当等软件故障，而许多软故障多与硬盘上的引导扇区的内容有关。我们必须弄清引导扇区的结构和功能，以便发生故障时能及时排除。
1 硬盘主引导扇区及引导扇区
　　硬盘的主引导扇区是位于硬盘的0柱面，0磁头，1扇区，它是由硬盘的低级格式化程序生成，其内容有3部份：（1）主引导程序（主引导记录MBR），（2）4个分区项，（3）结束标志字（55AA）。硬盘的主引导扇区为512B，启动微机系统时，系统首先对硬件设备进行测试，测试成功后进入自举程序INT 19H，然后读系统磁盘0柱面，0磁头，1扇区的主引导记录（MBR）内容到内存指定单元，0：7C00首址开始的区域，并执行MBR程序段。硬盘主引导记录（MBR）是不属于任何1个操作系统的，它先于所有操作系统而被调入内存并发挥作用。然后才将控制权交与主分区活动分区内操作系统，并让主分区信息表来管理硬盘。引导扇区是指硬盘中DOS分区开始的第1个扇区，即逻辑驱动器的第1个扇区又称BOOT区，经由FORMAT高级格式化写到该扇区，有5部分组成，即：（1）跳转指令，（2）厂商标识和DOS版本号，（3）BPB，（4）DOS引导程序，（5）结束标志字（AA55）。以上5部分共占用512B。其主要任务是重新设置引导驱动器，将根目录的第1个扇区装载到内存，检查FDT中的前2个文件是否为DOS的2个系统文件引，装载DOS系统隐藏文件I0．SYS和IBMI0．COM装载到内存。
2 硬盘引导扇区引导失败的修复
　　引起系统不承认硬盘或硬盘不能自举的原因大多是关键程序区和数据区信息损坏等软故障造成的。对于这类软故障。用户大都可以根据屏幕上出现的提示信息来判断引起故障的原因。概括起来可分为：CMOS数据参数丢失。硬盘引导区，主引导记录MBR损坏，硬盘DOS引导区引导记录（DBR）出错3种。
　　1．受损主引导扇区的修复
　　其一般故障有：（1）NO ROM BASIC（没有固化BASIC） SYSTEM HALT（系统停机）；（2）INVALID PARTITION TABLE（无效的分区表） INVALID DRIVE SPECIFICATION（无效的驱动器指令）；（3）ERROR LOADING OPERATION SYSTEM（装载操作系统错误）。
　　最直接的修复方法是：用FDISK重新分区，以形成正确的分区表，然后再用FORMAT命令重新建立引导记录，但这样会使所有数据全部丢失。我们可以利用DEBUG程序来完成修复工作，而原有数据不会受损。若发生分区表错误（主引导记录未被破坏），我们先用DEBUG读取硬盘主引导记录，然后在内存中修改正确，最后写回到硬盘的主引导扇区。
　　例如：若硬盘启动直接进入ROM－BASIC，或从A盘启动后键入C：却不能够进入C盘，而显示INVALID DRIVE SPECIFICATION，那么，我们可以采用该方法：
　　A＞ DEBUG
　　－A 100
****：0100 MOV AX，201
****：0103 MOV BX，200
****：0106 MOV CX，1
****：0109 MOV DX，80
****：010C INT 13
　　****：010E INT 3
　　****：010F ∧C－G－100 （将主引导记录读入200H开始的内存中）
　　－D 3B0 3FF （显示分区表，发现引导标志为“55”而不 
　　　　　　　　　　　　　　　　　　　是“80”或“100”
　　－E 3BE 80 （将引导标志改为80）
　　－E 102 3 （修改汇编小程序的第一条语句）
　　－G－100 （将修改后的主引导记录写入硬盘）
　　经以上修改，主引导记录的引导标志恢复为80，该故障现象消失。若主引导记录被破坏，可从另外一台启动正常、干净无毒且与有故障微机的硬盘分区相同的微机中获取未被破坏的主引导记录，再写回原硬盘。
　　2．受损引导扇区引导记录的修复
　　硬盘上引导记录（BDR）是在用DOS命令FORMAT对硬盘做格式化操作时生成的，硬盘BDR损坏以及DOS的3个系统文件损坏或丢失也都会引起硬盘不启动，故障处理方法也完全相同。 
　　其一般故障有： 
　　MISSING OPERATION SYSTEM 
　　NON－SYSTEM DISK OR DISK ERROR 
　　DISK BOOT FAILURE 
　　BAD OR MISSING COMMAND LNTERPETER
　　出现故障后，可用含有与原硬盘上操作系统版本相同的A盘启动后，在A＞提示符下运行：
　　A＞ SYS C：
　　当屏幕出现SYSTEM TRANSFERED时，表示系统文件传输成功。若出现：
　　NO SYSTEM ON DEFAULT DRIVE
说明执行命令的当前盘上，没有原启动计算机的DOS版本的3个系统文件。除运行SYS命令的方法外，还可利用NU，PCTOOLS等工具软件的扇区编辑功能直接对引导记录进行修复。
张红（辽宁省卫生职工医学院计算机室110005）
收稿日期：1999－08－16
