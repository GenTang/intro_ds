航空动力学报
JOURNAL OF AEROSPACE POWER
1998年 第3期 No.3 1998科技期刊
涡扇发动机机载自适应建模技术研究
　　李松林*　*　孙健国　黄金泉　李健民
南京航空航天大学
中国燃气涡轮研究所
【摘要】　本文研究用涡扇发动机可测输出参数偏离变化来表征发动机的非额定工作特性，将它们做为增广的状态量，设计卡尔曼滤波器进行最优估计，将这些估计值用于修正对发动机不可测参数和性能量的计算，以形成机载自适应模型。仿真研究表明，采用该方法建立的机载模型对性能蜕化所致的发动机非额定工作具有很好的适应能力。
　主题词：　涡轮风扇发动机　卡尔曼滤波　自适应控制　建立模型
　分类号：　V235.13　O242.1
1　引　言
　　按照发动机气动热力学特性和典型发动机试验特性数据建立的发动机数学模型一般只能表现额定特性，而不能对制造安装公差造成的特性差异和性能蜕化等因素导致的发动机非额定特性进行计算。于是，探求好的方法对按额定特性建立的模型进行修正来表示发动机的真实工作情况成为研究先进的飞行／推进系统综合控制技术及在线故障诊断首先必须解决的问题。80年代中期提出了设计部件跟踪滤波器来解决模型和发动机输出间的失配［1，2］。其缺点是运算量大，实时性差。80年代末期，提出了用发动机的五个部件偏差因子(又称效能参数)来表征发动机的非额定工作特性［3］，但难于求取模型中对应于这些部件偏差因子的系数矩阵元素。本文的方法认为任何使发动机偏离额定工作的因素都必然会引起可测参数的变化，因而可以用这些可测参数的变化量(称为偏离量)来表征发动机的非额定工作［4］。将它们视做增广的状态量，设计卡尔曼滤波器对之进行最优估计。这些偏离量估计值用于修正模型的输出，使模型输出与真实发动机的输出一致。该方法的优点是：实际意义明晰、直接方便、实时性好。
2　机载涡扇发动机自适应模型描述
　　本文以涡扇发动机为研究对象。它有5个控制量：主燃油量(WF)，喷口面积(A8)，加力燃油量(WFA)，风扇和压气机进口气流导叶角βf和βc；有5个测量参数：低压和高低转子转速XNL和XNH，燃烧室总压P4，低压涡轮进口总温T42，加力燃烧室进口总压P6。
2．1　机载涡扇发动机自适应模型结构
　　模型的输入为5个控制量和五个测量参数，输出为不可测参数：压气机进口总温、总压(P23，T23)，风扇和压气机换算流量(WA22C，WA3C)，加力燃烧室进口总温T6，以及由这些参数值经非线性计算得到的发动机性能量：风扇、压气机的喘振裕度(SMF,SMC)，发动机推

图1　涡扇发动机自适模型(ADEM)
力R等。图1是机载的涡扇发动机自适应模型(ADEM)结构框图。图中，下标“t”表示测量数据，下标“o”表示稳态基点数据，顶标“＾”表示估计值，虚框表示该模块要离线预先设计。
2．2　自适应模型各组成模块功能
　　(1)输入参数转换模块是将模型的输入参数转换成标准大气条件下参数。自适应模型按标准条件来建立，通过相似变换应用于全飞行包线。这样可节省存储量，以利实时处理。
　　(2)SVM模块是分段线性化的发动机状态变量模型，其形式为：
△＝A*△X+B*△U　，　△Y＝C*△X+D*△U
其中X=［PNF　PNC］T　，　Y=［PNF　PNC　PP4　PP6　PT42］T
U=［PWF　PA8　PWFA　Pβf　Pβc］T
　　模型参数采用无量纲形式，如PNF定义为：XNL÷(XNL)设计×100%，PA8定义为：A8÷(A8)设计×100%。以便提高系数矩阵条件数和计算精度。采用小扰动法在全飞行包线内求取50组SVM的系数矩阵，形成按P4查找的一维数表，存于SVM模块。
　　(3)ASVM模块是以可测输出的偏离量：PNFB，PNCB，PP4B，PP6B，PT42B表征发动机非额定工作，视为增广的发动机状态量扩充至SVM中形成的增广状态变模型，其形式为：
△＝AA*△Z+BB*△U　，　△Y＝CC*△Z+D*△U
其中Z=［X　YB］T　，　△YB=［PNFB　PNCB　PP4B　PP6B］T

YB为输出偏离向量，在状态方程中为增广状态量，在输出方程中它补偿SVM输出。B=0，因相对于快速动态过程来说，非额定发动机工作导致输出量的偏离变化率极缓慢［6］。
　　(4)卡尔曼滤波器（KF）设计模块是自适应模型的核心，它构成常值增益的卡尔曼滤波器，对ASVM中的增广状态量Z进行次优估计，从而估计出输出偏离量。这个滤波器的形式是：
△
K为Kalman滤波器常值增益阵，也是离线预先算好，同存于矩阵系数表中，按P4查值［6］。
　　(5) SSVM模块将滤波器估计出的输出偏离量YB用于修正模型非测量参数的计算，使模型输出与真实输出一致。这个校正运算关系为(SSVM)：
△Yaux＝［H1[｜〗H2］　［△X[｜〗△Yb］τ+F*△U
Yaux＝［PP23　PT23　PWA22C　PWA3C　PT6］T
SSVM中的各参数同样采用了以设计点参数值进行归一化处理的形式。WA22C和WA3C分别为风扇和压气机的换算流量。模型中H1阵和F阵同样用小扰动方法从非线性发动机模型提取。H2阵是输出偏离量系数矩阵，用模拟发动机蜕化的方法，在得到控制量作用下的△YB和△Yaux后用广义求逆计算出［7］。为使稳态校正计算有较高的精度，求取能覆盖全飞行包线的近200余组SSVM系数矩阵，构成一个按P4和P6查值的二维数表存于SSM模块中。
　　(6)SSM模块是一个按P4、P6查找的二维发动机稳态数表［7］。
　　(7)输出参数转换模块用相似论将标准状况下发动机参数值换算到真实状况下参数值。
　　(8)非线性计算模块是在真实状况下由Yaux计算发动机的性能量：发动机推力、风扇、压气机裕度等。由于Yaux的计算包含了发动机的非额定特性，所以基此进行的性能量计算也就能反映发动机的真实工况。该模块实际上是普通的气动热力计算［7］。本文不赘述。
3　ADEM对发动机的非额定工作适应能力仿真评价
　　首先用非线性部件级模型(NLEM)仿真发动机蜕化非额定工作：将风扇和压气机效率同时下降2.5%，给一个供油量小阶跃△PWFB=0.5%，用NLEM计算这一非额定发动机动态过程；第二步将NLEM仿真计算的输出值混入标准差为0.02的正态分布白噪声(这比参考文献［4］提供的从F100发动机飞行数据分析得到的测量噪声水平提高了一个数量级)后送入ADEM；最后将ADEM滤波输出与NLEM计算输出进行比较，以此评价ADEM对发动机非额定工作适应能力。限于篇幅，仅给出在高度为10 km，马赫数为2.0，A8=0.1928686 m2，WF=0.2237480 kg/s，其他控制量都为零时的发动机稳态平衡点处进行的仿真分析结果。

图2　受噪声污染的蜕化发动机对主燃油量的阶跃响应
图2是受噪声污染的蜕化发动机对WFB阶跃响应曲线；图3是ADEM滤波输出与NLEM计算的蜕化发动机输出对比图，可以看到蜕化并混入噪声后的发动机输出经ADEM后，噪声几乎滤去，大多数ADEM输出都能紧紧跟踪真实发动机输出，有的要经过一段时间后才能逼近真实值，这是因为ADEM的初始偏离量估计值为零，需要经过一段时间后才能获得

图3　ADEM输出与仿真蜕化发动机输出比较
（实线曲线：蜕化发动机输出；虚线曲线自适应模型输出）

图4　自适应模型(ADEM)对蜕化发动机输出偏离量的估计
正确的偏离输出补偿值；图4是ADEM在此情况下估计出的输出偏离量值。显然，由于发动机的蜕化工作，输出偏离值应当从初始零值过渡到一个新水平的稳定值以补偿ADEM输出，使之逼近发动机真实输出值，图4恰能反映我们的分析。
4　结　论
　　本文将发动机可测输出参数的偏变化离量直接模化，以卡尔曼滤波器对之进行最优估计，用此补偿模型输出,形成了机载自适应模型,并用非线性、部件级模型代替真实发动机进行了仿真分析，研究结果表明ADEM有很好的适应能力。
参　考　文　献
1　Tich E J,ect.Performance Seeking Control for Cruise Optimization in Fighter Aircraft.AIAA-B6-1929
2　兰春贤，孙健国．基于部件跟踪滤波器的解析余度技术．航空动力学报，1994,9(3):289-292
3　Luppold R H,etc.Estimating In-Flight Engine Performance Variations Using Kalman Filter Concepts.AIAA-B9-2584, 1989
4　G Alag etc.A Proposed Kalman Filter Algorithm for Estimation of Unmeasured Output Variables for an F100 Turbofan Engine.AIAA-90-1920
5　李松林，孙健国，李健民．涡扇发动机增广变量模型(ASVM)和卡尔曼滤波器(KF)研究报告．624所科技术档案，1996,24.1.1.14
6　李松林，孙健国，李健民．涡扇发动机自适应模型(ADEM)研究报告．624所科技档案，1996,24.1.1.14
7　李松林，孙健国，李健民．涡扇发动机状态变量模型(SVM)和稳态变量模型(SSVM)研究报告．624所科技档案，1996,24.1.14
（责任编辑　王震华）
1997年9月收稿；1998年1月收到修改稿。　*潮疚南岛娇湛蒲Щ金资助项目，编号：95C209
*　*男　33岁　博士生　高级工程师　南京航空航天大学动力工程系　210016
