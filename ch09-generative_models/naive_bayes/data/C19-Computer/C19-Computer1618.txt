信息与控制
Information and Control
1999年　第28卷　第5期　Vol.28　No.5　1999



一种求解离散LQ问题的遗传算法
魏　鹏　林家恒　耿　宝

　　摘　要：提出了一种实用的求解离散LQ问题的改进型遗传算法，给出了状态反馈阵K取值范围的确定方法，设计了一种变异概率可变的变异算子，大大提高了算法的优化速度．仿真结果表明了该算法的有效性，并且改进后的算法明显优于简单遗传算法．
　　关键词：离散LQ问题, 遗传算法, 参数空间映射
　　中图分类号：TP13　　　　　　文献标识码：B

A GENETIC ALGORITHM FOR SOLUTION OF THE
DISCRETE LQ PROBLEM
WEI Peng1 LIN Jia-heng2 GENG Bao2
(1. Shandong Power Transmisson Co., Jinan 250022; 2. Dept. of Auto, Shandong University of Technology, Jinan 250061)
Abstract　In this paper,a kind of improved genetic algorithm is proposed for solution of the discrete LQ problem.A method to get the definite scope of the state feedback matrix K is presented.The genetic algorithm in whic h the mutation probability can vary is designed.This approach can improve optimi zation speed of the algorithm greatly.The results of the computer simulation sho w its validity and the improved algorithm is superior to the simple genetic alg orithm evidently.
Key words　discrete LQ problem, genetic algorithm, parameter s pace map

1　引言
　　离散LQ问题是最优控制理论中的一类典型问题，在实际控制工程中应用广泛．求解此类问题的经典方法是通过求解矩阵代数Riccati方程获得最优状态反馈矩阵，而求解Riccati方程比较复杂，且计算量较大.
　　遗传算法是一种基于自然选择和自然遗传学机理上的随机搜索算法[1]．由于遗传算法仅要求所优化的问题是可计算的，无可微性及其它要求，适用范围极广，并且具有全局收敛、鲁棒性好、计算简单等优点，因此该算法近年来引起了人们的普遍重视，在组合 优化、机器学习、模式识别、参数辩识及最优控制等诸多领域获得了成功的应用．文[2]采用遗传算法求解线性多变量系统输出反馈特征结构配置问题，文[3]针对自动交会控制器设计,应用遗传算法求解最优状态反馈阵K．但在这些论文中,都没有解决遗传算法所必需 的状态反馈阵K的取值范围确定问题，K阵的取值范围都是根据具体问题来假设的，同时所采 用的方法都是简单遗传算法SGA(Simple genetic algorithm)，算法的计算时间较长， 因此这些算法缺乏实际的应用价值．
　　本文在文[4]的基础上,从“良好稳定区”的概念出发，利用参数空间映射关系，提出 了一种状态反馈阵K的取值范围的确定方法，并设计了一种改进型遗传算法IGA(Improved genetic algorithm)．仿真结果表明IGA明显优于SGA．
2　K阵取值范围的确定
　　设线性定常可控离散系统:
X(k+1)=AX(k)+BU(k)　　　　　　　　　　　　　(1)
其中X(k)∈Rn, U(k)∈Rm, A和B分别为对应维数的常数矩阵．求状态反馈矩阵K ，K∈Rn×n使最优控制规律
U(k)=-KX(k)　　　　　　　　　　　　　　　(2)
且线性二次型性为
　　　　　　　(3)
其中Q∈Rn×n, R∈Rm×m,且Q≥0,R＞0.
对于上述离散LQ问题，K阵可由下面一组递推公式求出：
　　　　　(4)
可见由式（4）推出K阵，计算复杂，计算时间很长．此问题也可用遗传算法求解，但必需首先确定K阵的取值范围，并且其取值范围越小，遗传算法的计算时间越短． 因此如何确定一个合适的K阵取值范围，对遗传算法求解此类问题来说，至关重要．
2．1 良好稳定区
　　为保证闭环系统稳定且具有良好的时域特性，闭环极点在根平面上所分布的区域，称为 良好稳定区．对于离线LQ最优控制，良好稳定区应是Z平面单位圆内的ΓL域 ， 如图1（a）所示[4]．考虑到闭环极点若位于Z平面左半单位圆内时，相应的暂态分量的振荡频率较高，故闭环极点不宜配置在左半单位圆内．同时考虑到参数映射计算方便起见，故选取Z平面右半单位圆内，以(1/2,0)为圆心，半径为1/2的圆域ΓG为良好稳定区，如图1（b）所示．

图1 离散LQ问题的良好稳定区

　　良好稳定区ΓG的确定，不仅可保证离散线性最优控制所需的极点配置，而且可大大 缩小遗传算法的参数搜索空间，有效地提高算法的求解速度，使遗传算法真正具有实用价值 ．
2．2 参数空间映射
　　对于受控系统（A,b），状态反馈阵K=[k1,k2,…,kn]在什么范围内取值，才能 保证闭环系统的特征值在良好稳定区内，此问题可分两步来解决．先把良好稳定区ΓG映 射到闭环特征方程ac(z)的系数空间aT=[a0, a1, …, an-1]， 然后再将aT映射到K空间．由参数空间映射关系知，当Z域的“良好稳定区”边界为 圆时（如图2所示），这个圆在аT空间的凸包顶点可由下式算出：
αi(z)=(z-τL)i(z-τR)n-i,　i=0,1,2,…,n　　　　　　　　　(5)

图2 Z平面上限制闭环极点的圆

其中n为系统的阶数．因此，一个圆在aT空间的凸包有n+1个顶点．由于aT空间的凸包映射到K空间后也是凸包，故只需按照下面的极点配置公式映射上述空间的凸包顶点：
K=[αT, 1]E　　　　　　　　　　　　　　(6)
其中E为极点配置矩阵，E∈R(n+1)×n:
E={eT,eTA,…,eTAn}T　　　　　　　　　　　　　　　(7)
eT=[0,0,…,0,1][b,Ab,…,An-1b]-1　　　　　　　　　　(8)
3　遗传算法
3．1 算法一：SGA
　　1) 首先运用公式（5）～（8）确定状态反馈阵K的解集范围，并用二进制对解集进行编码．二进制数字串的表示值与实际kI值之间有如下关系：
　　　　　　　　　　　　(9)
其中binrep(t)为一由L位数字串所表示的二进制整数，[kimax,kimin]为反馈增益ki的变化范围．
　　2) 随机产生2N个串的初始解群P．
　　3) 由公式（3）计算种群中每个个体的目标函数（适应值）J,并找出所有个体中J最小的适值，令Jbest=Jmin．
　　4) 随机从种群中选出两个个体，比较其适应值，并将适应值较小的个体加入下一代种群P′1中，重复N次．
　　5) 从P′1 中随机选择两个串，进行交叉运算．即随机产生一个数字串的位号， 将这两个串分别分成两段，并将这两串的后半段相互交换．再将子串加入到P′2,重复 N/2次．将P′11和P′2合并，重新形成包含2N个个体的新种群P′．
　　6) 对新种群中的个体按概率Pm进行变异运算．即随机产生一个数字串的位号， 对该位上的二进制数码取反运算．
　　7) 计算变异后的新种群中每个个体的适应值，并找出其中适应值最小的个体，令J best=Jmin．
　　8) 判断收敛条件．若某一个最小适应值所对应的个体连续出现10次，则求解结束， 并将这个个体作为问题的最优解输出．否则，返回步骤4）．
3．2 算法二：IGA
　　大量实验表明，在SGA中，变异概率Pm对SGA的迭代过程影响很大．当Pm增大时，每一代种群中变异的个体数目相应增加，导致种群中基因的分散性．因而使收敛时间变长．但同时又使算法可以跳出局部最小解，有利于得到全局最优解．当Pm减小时，对算法的影响恰恰相反．为提高算法的精度并减小计算时间，我们在SGA的基础上，提出了一种改进的遗传算法IGA．两者之间的区别，在于第六步变异运算．SGA中Pm是固 定不变的，而IGA中Pm是可变的，Pm随迭代步数的增大而逐渐减小，直至满足收敛 条件．
4　数字仿真
　　考虑如下二阶线性离散系统


求最优状态反馈阵K，使性能指标函数J最小．由良好稳定区，按照参数空间映射关系得：


则在K空间的映射为：

如图3所示．K阵中每一元素用16位二进制字符串表示， 则一个K阵用一个32位长的字符串表示．适应值函数J中n=30．运用上述两种遗传算法进行优化运算，其中IGA中每迭代10次 ，Pm减小初始值的0.0116倍．遗传算法的参数和运算结果如表1所示．图4和图5分别给出 了IGA的平均适值和最佳适值随迭代次数的变化曲线．

图3　K空间的映射

图4 群体适应值的均值 　　　　　　　　图5 群 体中最佳适应值

　　由实验结果可以看出，在IGA中当Pm较大时，解群的基因变化剧烈．而随着Pm 的减小，计算很快收敛．另外，无论从计算精度和速度方面，IGA均明显优于SGA．
表1 SGA与IGA优化结果比较

参数SGASGAIGA精确解
N100100100
Pm1/3001/201/20～1/300
Pc0.9990.9990.999
J4.9178674.914934.9148354.9147
K[-0.663153,1.311194][-0.6592661.312025],[-0.666621,1.313991][-0. 66,1.31]
迭代次数5920043
计算时间（秒）5154

　
5　结束语
　　本文针对求解离散LQ问题，提出一种改进的遗传算法.利用良好稳定区的概念和参数空 是映射关系解决了状态反馈阵K的取值范围的确定问题，有效地减小了算法的搜索空间.采 用了Pn可变的变异算子，大大提高了计算精度和速度.因此该算法具有实际应用价值.但 对于多输入系统如何确定K阵的取值范围尚待进一步研究.
作者简介：魏　鹏，男，1971年，硕士研究生毕业．研究领域为最优控制，智能控制．
　　　　　林家恒，男，1947年生，教授．研究领域为智能控制、神经网络和最优化方法．
　　　　　耿　宝，男，1951年生，高级实验师．研究领域为系统仿真、计算机控制．
作者单位：魏　鹏：山东送变电公司 济南 250022; 林家恒、
　　　　　耿　宝：山东工业大学自动化系济南 250061
参考文献
1　Holland,J.H. Adaptation in Natural and Artificial Systems. The University of Michigan Press. Ann Arbor,MI,1975
2　陈根社，陈新海．采用遗传算法求解特征结构配置． `93控制理论及其应用年会 论文集，武汉，1993：11～15
3　陈根社，陈新海．应用遗传算法设计自动交会控制器．西北工业大学学报，1994，12（2）：247～253
4　曾葵荃．计算机反馈系统的鲁棒性设计．北京：科学出版社，1992，247～305
收稿日期：1998-05-12
