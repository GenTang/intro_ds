计算机应用研究
APPLICATION RESEARCH OF COMPUTERS
2000　Vol.17　No.2　P.106-108



模糊集在目标识别上的应用
陈海燕　戚飞虎
摘 要 对于复杂背景下的模式识别，目标识别一直是一个较难解决的问题。本文提出在提取目标的多个特征的基础上用模糊隶属度表征各个特征的重要性的方法来选取目标，近而成功地识别目标。文中给出了一个成功的应用实例一车牌自动识别系统，收费道口现场实验表明，在分割和字符切分正确的基础上，此模型的目标识别率为99%。
关键词 目标识别 模糊事件 隶属度
1 引言
　　在复杂背景模式识别系统中，目标识别其总体上可以分为两类。其一是通过模板匹配等方法直接找到目标[1]，这类方法在目标简单时精度高，但其计算量非常大，尤其当目标复杂、模板数多时，很难达到实际应用的要求；另一类先通过预处理，分割等找出若干准目标区域[2](如特征纹理近似的或多目标的系统)，然后从这些区域中选取目标区域。这种方法步骤比较繁琐，但是大大减少了计算量且不受模板的限制。在第二类方法中关键是如何选取的问题。直接模板匹配方法不适用于车牌等复杂目标；最小距离的方法中距离的计算也很困难。本文提出用模糊集理论来融合模式多个特征的方法(包括直接从图象中提取的纹理和几何特征以及模式识别结果等)来选取目标，并给出了一个成功的应用实例－
2 模糊集理论
2.1 模糊事件
　　根据模糊集理论[3]，模糊事件可以表示为三元组{Ω，K，P}，Ω={r0，r1，…，rL-1}为其特征集，P={Pr(r0)，Pr(r1)，…，Pr(rL-1)}为其特征的评价集，K={k|k=0，1，…，L-1}。我们可以用模糊集A∈Ω来描述模糊事件存在的可能性大小，令其隶属函数为μA (rk)，则模糊事件存在的可能性可由式(1)计算：
　　(1)
　　如我们要评价一件衣服的受欢迎程度这一模糊事件，其特征集为{颜色、款式、价格}，如果求出某一颜色/款式/价格的衣服的受欢迎程度Pr(rk)，以及颜色/款式/价格对衣服受欢迎程度的影响力大小μA(rk)，那么用式(1)就可以求出任意一件衣服的受欢迎程度。
2.2 模糊隶属函数的选取方法
　　隶属函数的选取方法主要有基于模糊统计的方法和基于二元对比排序的方法[4～6]。基于模糊统计的方法主要适用于比较简单的情况；对于有多种因素影响的模糊事件来说，二元对比排序方法可以有效排除因素间的相互干扰。
　　设U={u1, u2, ..., uq}为有限论域，为设定的U上模糊集，待求，假定P={p1，p2，…，pn}为被调查者集，二元对比排序方法的基本算法可以描述为：
　　对被调查者pj对比us与uk认为则记为
　　当s≠k时，显然有下列性质：
　　1)
　　2)
　　这时，可按下式计算：
　　(2)
　　显然满足：
3 基于模糊事件的目标选取方法
　　基于模糊事件的目标选取方法，实际就是找到对目标这一模糊事件的描述。这样P(A)的值最大者就可以认为是所要找的目标。
　　根据模糊事件的定义我们可以知道需要解决三个关键问题：特征提取、特征评价集和每一特征对目标识别的重要性。
　　首先需要对模式进行特征提取，选取最关键的且能全面描述目标模糊事件的特征。应用于模式识别中的数字图象特征提取的方法很多，有一阶灰度统计量的特征提取、纹理特征的提取、自/互相关特征和几何特征等等[7, 8]。
　　然后，针对每一特征找出合适的评价函数。实际上对于每一个选出的特征，我们给出其近似的标准样本，并给出给定模式与标准的相似度的函数。对于每一模式，我们只需由这些函数算出其评价，从而得到(1)式中的评价集。为了方便比较各个特征对目标的重要性，我们将其归一化到[0，1]。
　　最后，我们必须知道每一特征对目标的重要性，也即怎样选取隶属函数。令A={能帮助成功选取目标的模式特征的集合}，区域i为样本a中的目标区域，而区域j为样本a中的噪声区域，它们分别有评价集Pi={Pi (r1),Pi(r2), ...,Pi(rL-1)}和Pj={Pj(r1)，Pj(r2)，…，Pj(rL-1)}。
　　定义
　　(3)
　　将其代入式(2)就可以求出隶属度函数了。
　　在进行目标选取时，我们只要根据每一特征的评价函数求出其评价值。而后由式(1)算出的值最大的那一个就是目标。
4 应用实例与实验分析
4.1 应用实例
　　随着交通的发展，尤其是高速公路、隧道、路桥的高速发展，车辆收费系统的效率的提高是一个极其迫切的需要。现在广深(广州-深圳)高速公路因为车流量大收费速度跟不上，造成收费道口车辆排成近1公里的现象经常发生。单纯的IC卡系统虽然能有效提高收费速度，甚至实现自动收费，但它却无法防止司机通过换卡方式进行逃票，造成很大的损失。所以随着高速公路收费系统的发展车牌自动识别系统的需求越来越迫切。但收费道口现场光线条件复杂以及车牌本身的破损、变形、脏等现象的影响，另外对高速行驶的车辆进行拍照得到的车牌图象不仅背景复杂，而且图象的清晰度、车牌图象的大小都难以保障，这些因素的影响使得车牌自动识别系统的识别率的提高非常困难[1]。
　　在我们的车牌自动识别系统中，首先对所摄取的车辆图象进行预处理，找出与车牌纹理相似的若干区域。然后对这些区域一一进行字符切分和识别得到了各个可能车牌(这里我们称之为准车牌)的字符识别结果。最后的关键就是从这些准车牌中挑选出真正的车牌，这也就是这里我们要讨论的步骤。其实现可以分为三步：
　　第一步：车牌特征的提取
　　在这里我们不仅使用了图象的特征如几何特征、竖直投影等，我们还利用了前面处理过程中的信息，如神经网络的输出，字符切分的变化等。
　　(1)几何特征(size)
　　所有准车牌都是矩形，几何特征只需要其尺寸大小就可以准确描述。这里由给定区域经字符切分滤波器剩下的区域与标准车牌的长、宽及长宽比的相似度可以全面地反映考察区域的几何特征。
　　记车牌的标准长为s1，标准宽为s2，标准长宽比为s3，x1、x2和x3为所考察区域的长、宽和长宽比，则几何特征R1可由式(5)求出。
　　(4)
　　(5)
　　(2)竖直投影特征(project)
　　它根据所取区域的竖直投影和标准车牌的竖直投影的相似度给出。这里先需要进行对噪声的处理，采用高通滤波技术，去除小噪声。图1和图2显示了用同样的方法得到的车牌和噪声区域的投影图。由图中可以看出，经过滤波处理得到的车牌图象的投影图有7个明显的峰，且峰点排列具有均匀性(除第二和第三个峰间距离比较远)。而同样处理得到的噪声图象的投影则比较杂乱。

图1　车牌的竖直投影

图2　噪声区的竖直投影
　　(3)字符的识别置信度(char)：
　　字符的识别置信度由神经网络对每一个字符的识别置信度(归一化为[0, 1])的平均值给出。神经网络的输出虽然并不能很好地描述所割出来的部分是否为字符，但根据统计结果显示表明，当所割出来的部分为字符时，所得到的置信度一般来说比较高。用这一结果来比较准车牌与车牌的相似度是很有效的。
　　(4)滤波器特征(filter)
　　来自用于字符切分的一组滤波器的处理结果，它基于一个假设：以二值化图生长出来的字符数为基准，后面的滤波器处理后字符数变化越大，则置信度越低。记第i个滤波器处理前切分所得的字符数为pi，处理后切分所得的字符数为qi，则滤波器置信度可以由式(6)求得。
　　(6)
　　(5)沟的大小及位置(gap)
　　根据切分得到的各字符中心的距离与标准车牌中各字符中心的距离的标准方差给出。
　　第二步：隶属函数的选取
　　根据应用中多特征且不存在占绝对优势的特征的特点，我们采用了两元对比排序的方法来确定隶属函数。我们使用了266幅图象，比较了834个噪声和所在图象中的车牌区域的各个特征的优劣。统计结果见表1。
表1　的值
uIui
charFilterGapSizeProject∑
Char......6807065725392497
Filter154......5155524031624
Gap128319......3254651237
Size262282509......6281684
Project295431369206......1301
　　由表1中的数据，根据式(2)计算可得隶属函数的值(见表2)。从表2中可以看出这五个置信度的重要性相差不是太远，所以任何一个特征都是相当重要的、非冗余的。 
表2　隶属度函数值
　charFilterGapsizeProject
0.29940.19470.14830.20150.1559
　　第三步：目标识别
　　根据式(1)算出每一准车牌为车牌的可能性评价值。而后比较车辆图象中所有准车牌的可能性评价值，值最大者即认为是我们所求的目标。
4.2 试验结果与分析
　　本文共使用车牌区域正确分割到并且其字符切分样本1,219个，其中266个用来训练，953个用来测试，其正确率都在99%以上。实验结果见表3。 
表3 系统识别率
　样本数正确将车牌区域挑选出来正确率
训练样本26626599.62%
测试样本95394499.05%
　　此方法可以有效区分车牌与其很相似的区域如ISUZU商标、养路费牌照等，同时由统计结果也表明如果去掉其中任何一个特征都将导致正确率的下降。具体数据见表4和表5。 
表4　图2(1)准车牌置信度分析表
区域特　　　　　　　　征
CharFilterGapSizeProject总置信度
A..............................0.00
B0.640.830.500.690.830.70
C0.130.160.500.390.830.42
D0.490.160.500.850.000.35
E0.820.700.680.780.880.78
表5　图2(2)中准车牌信度分析表
区域特　　　　　　　　征
CharFilterGapSizeProject总置信度
F..............................0.00
G0.590.091.00.240.60.48
H..............................0.00
0I0.560.240.320.100.250.32
J0.760.500.500.320.880.60
K0.741.00.680.861.00.85
5 结论 
　　针对复杂背景模式识别系统中目标识别这一难点，本文提出在提取目标的多个特征的基础上用模糊隶属度表征各个特征的重要性的方法来选取目标。试验表明，该方法能成功地从相似区域中将目标区域挑选出来。文中给出了一个成功的应用实例―车牌自动识别系统。收费道口现场实验表明，在分割和字符切分都正确的基础上，此模型的目标识别率为99%。
陈海燕（上海交通大学计算机系 上海 200030）
戚飞虎（上海交通大学计算机系 上海 200030）
参考文献
1，Paolo Comelli, Paolo Ferragina et al.. Optical Recognition of Motor Vehicle Licnese Plates, IEEE Transactions on Vehicular Technology. Vol. 44, No.4, Nov. 1995
2，R.Mullot, C.Olivier, et al.. Automatic Extraction Methods of Container Identity Numbers and Registration Plates of Cars, IECON'91
3，L.A.Zadeh. Probability measures of fuzzy events, J. Math. Anal. Appl. 23, 421～427, 1968 
4，李洪兴, 汪 群编. 工程模糊数学方法及应用. 北京：科学技术出版社, 1993
5，郭宗祥, 杨鸿铨编. 模糊信息处理基础. 成都：成都电讯工程学院出版社, 1989
6，何新贵著. 模糊知识处理的理论与技术. 北京：国防工业出版社, 1994
7，李金宗. 模式识别导论. 北京：高等教育出版社, 1994
8，边肇祺等. 模式识别. 北京：清华大学出版社, 1988
收稿日期：1999年7月31日
